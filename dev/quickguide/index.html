<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started · PowerWaterModels</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-367975-10"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-367975-10', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PowerWaterModels</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Installation-of-PowerWaterModels"><span>Installation of PowerWaterModels</span></a></li><li><a class="tocitem" href="#Installation-of-an-Optimization-Solver"><span>Installation of an Optimization Solver</span></a></li><li><a class="tocitem" href="#Solving-an-Optimal-Power-Water-Flow-Problem"><span>Solving an Optimal Power-Water Flow Problem</span></a></li><li><a class="tocitem" href="#Obtaining-Results"><span>Obtaining Results</span></a></li><li><a class="tocitem" href="#Accessing-Different-Formulations"><span>Accessing Different Formulations</span></a></li><li><a class="tocitem" href="#Modifying-Network-Data"><span>Modifying Network Data</span></a></li><li><a class="tocitem" href="#Alternate-Methods-for-Building-and-Solving-Models"><span>Alternate Methods for Building and Solving Models</span></a></li></ul></li><li><a class="tocitem" href="../network-data/">Network Data Format</a></li><li><a class="tocitem" href="../result-data/">Result Data Format</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../formulations/">Network Formulations</a></li><li><a class="tocitem" href="../specifications/">Problem Specifications</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Modeling Components</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../objective/">Objective</a></li><li><a class="tocitem" href="../constraints/">Constraints</a></li></ul></li><li><a class="tocitem" href="../parser/">File I/O</a></li></ul></li><li><a class="tocitem" href="../developer/">Developer</a></li><li><a class="tocitem" href="../examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lanl-ansi/PowerWaterModels.jl/blob/master/docs/src/quickguide.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quick-Start-Guide"><a class="docs-heading-anchor" href="#Quick-Start-Guide">Quick Start Guide</a><a id="Quick-Start-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start-Guide" title="Permalink"></a></h1><p>The following guide walks through the solution of an optimal power-water flow (<code>opwf</code>) problem using the <code>LinDist3FlowPowerModel</code> power distribution network formulation (specified via <a href="https://github.com/lanl-ansi/PowerModelsDistribution.jl">PowerModelsDistribution</a>) and the <code>PWLRDWaterModel</code> water distribution network formulation (specified via <a href="https://github.com/lanl-ansi/WaterModels.jl">WaterModels</a>).</p><h2 id="Installation-of-PowerWaterModels"><a class="docs-heading-anchor" href="#Installation-of-PowerWaterModels">Installation of PowerWaterModels</a><a id="Installation-of-PowerWaterModels-1"></a><a class="docs-heading-anchor-permalink" href="#Installation-of-PowerWaterModels" title="Permalink"></a></h2><p>The latest stable release of PowerWaterModels can be installed using the Julia package manager with</p><pre><code class="language-julia hljs">] add PowerWaterModels</code></pre><p>For the current development version, install the package using</p><pre><code class="language-julia hljs">] add PowerWaterModels#master</code></pre><p>Finally, test that the package works as expected by executing</p><pre><code class="language-julia hljs">] test PowerWaterModels</code></pre><h2 id="Installation-of-an-Optimization-Solver"><a class="docs-heading-anchor" href="#Installation-of-an-Optimization-Solver">Installation of an Optimization Solver</a><a id="Installation-of-an-Optimization-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Installation-of-an-Optimization-Solver" title="Permalink"></a></h2><p>At least one optimization solver is required to run PowerWaterModels. The solver selected typically depends on the type of problem formulation being employed. Because of the <code>LinDist3FlowPowerModel</code>/<code>PWLRDWaterModel</code> joint formulation, the overall model considered in this tutorial is mixed-integer <em>nonconvex</em> quadratic. One example of an optimization package capable of solving this problem is the mixed-integer nonlinear programming solver <a href="https://github.com/lanl-ansi/Juniper.jl">Juniper</a>. Juniper itself depends on the installation of a nonlinear programming solver (e.g., <a href="https://github.com/jump-dev/Ipopt.jl">Ipopt</a>) and a mixed-integer linear programming solver (e.g., <a href="https://github.com/jump-dev/HiGHS.jl">HiGHS</a>). Installation of the JuMP interfaces to Juniper, Ipopt, and HiGHS can be performed via the Julia package manager, i.e.,</p><pre><code class="language-julia hljs">] add JuMP Juniper Ipopt HiGHS</code></pre><h3 id="(Optional)-Installation-of-Gurobi"><a class="docs-heading-anchor" href="#(Optional)-Installation-of-Gurobi">(Optional) Installation of Gurobi</a><a id="(Optional)-Installation-of-Gurobi-1"></a><a class="docs-heading-anchor-permalink" href="#(Optional)-Installation-of-Gurobi" title="Permalink"></a></h3><p>Juniper is likely <em>not</em> the best candidate to solve the mixed-integer nonconvex quadratic problem considered in this tutorial. As another example, the commercial package <a href="https://github.com/jump-dev/Gurobi.jl">Gurobi</a> can be used in its place. Assuming Gurobi has already been configured on your system, its Julia interface can be installed using the package manager with</p><pre><code class="language-julia hljs">] add Gurobi</code></pre><h2 id="Solving-an-Optimal-Power-Water-Flow-Problem"><a class="docs-heading-anchor" href="#Solving-an-Optimal-Power-Water-Flow-Problem">Solving an Optimal Power-Water Flow Problem</a><a id="Solving-an-Optimal-Power-Water-Flow-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-an-Optimal-Power-Water-Flow-Problem" title="Permalink"></a></h2><p>After installation of the required solvers, an example optimal power-water flow problem (whose file inputs can be found in the <code>examples</code> directory within the <a href="https://github.com/lanl-ansi/PowerWaterModels.jl">PowerWaterModels repository</a>) can be solved via</p><pre><code class="language-julia hljs">using JuMP, Juniper, Ipopt, HiGHS
using PowerWaterModels
const WM = PowerWaterModels.WaterModels

# Set up the optimization solvers.
ipopt = JuMP.optimizer_with_attributes(Ipopt.Optimizer, &quot;print_level&quot; =&gt; 0, &quot;sb&quot; =&gt; &quot;yes&quot;)
highs = JuMP.optimizer_with_attributes(HiGHS.Optimizer, &quot;log_to_console&quot; =&gt; false)
juniper = JuMP.optimizer_with_attributes(
    Juniper.Optimizer, &quot;nl_solver&quot; =&gt; ipopt, &quot;mip_solver&quot; =&gt; highs,
    &quot;branch_strategy&quot; =&gt; :MostInfeasible, &quot;time_limit&quot; =&gt; 60.0)

# Specify paths to the power, water, and power-water linking files.
p_file = &quot;examples/data/opendss/IEEE13_CDPSM.dss&quot; # Power network.
w_file = &quot;examples/data/epanet/cohen-short.inp&quot; # Water network.
pw_file = &quot;examples/data/json/zamzam.json&quot; # Power-water linking.

# Parse the input files as a multi-infrastructure data object.
data = parse_files(p_file, w_file, pw_file)

# Perform OBBT on water network to improve variable bounds.
WM.solve_obbt_owf!(data, ipopt; use_relaxed_network = false,
    model_type = WM.CRDWaterModel, max_iter = 3)

# Use WaterModels to set the partitioning of flows in the water network.
WM.set_flow_partitions_num!(data, 5)

# Specify the power and water formulation types jointly.
pwm_type = PowerWaterModel{LinDist3FlowPowerModel, PWLRDWaterModel}

# Solve the joint optimal power-water flow problem and store the result.
result = solve_opwf(data, pwm_type, juniper)</code></pre><h3 id="(Optional)-Solving-the-Problem-with-Gurobi"><a class="docs-heading-anchor" href="#(Optional)-Solving-the-Problem-with-Gurobi">(Optional) Solving the Problem with Gurobi</a><a id="(Optional)-Solving-the-Problem-with-Gurobi-1"></a><a class="docs-heading-anchor-permalink" href="#(Optional)-Solving-the-Problem-with-Gurobi" title="Permalink"></a></h3><p>Note that <a href="https://www.gurobi.com/documentation/9.1/refman/nonconvex.html">Gurobi&#39;s <code>NonConvex=2</code> parameter setting</a> ensures it will correctly handle the nonconvex quadratic constraints that are associated with the power network formulation. The problem considered above can then be solved using Gurobi (instead of Juniper) via</p><pre><code class="language-julia hljs">import Gurobi

# Solve the joint optimal power-water flow problem and store its result.
gurobi = JuMP.optimizer_with_attributes(Gurobi.Optimizer, &quot;NonConvex&quot; =&gt; 2)
result_grb = solve_opwf(data, pwm_type, gurobi)</code></pre><p>First, note that Gurobi solves the problem much more quickly than Juniper. Also note the difference in the objectives obtained between Juniper and Gurobi, i.e.,</p><pre><code class="nohighlight hljs">result[&quot;objective&quot;] - result_grb[&quot;objective&quot;] # Positive difference.</code></pre><p>The objective value obtained via Gurobi is <em>smaller</em> than the one obtained via Juniper, indicating that Gurobi discovered a better solution.</p><h2 id="Obtaining-Results"><a class="docs-heading-anchor" href="#Obtaining-Results">Obtaining Results</a><a id="Obtaining-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Obtaining-Results" title="Permalink"></a></h2><p>The <code>solve</code> commands in PowerWaterModels return detailed results data in the form of a Julia <code>Dict</code>. This dictionary can be saved for further processing as follows:</p><pre><code class="language-julia hljs">result = solve_opwf(data, pwm_type, juniper)</code></pre><p>For example, the algorithm&#39;s runtime and final objective value can be accessed with</p><pre><code class="nohighlight hljs">result[&quot;solve_time&quot;] # Total solve time required (seconds).
result[&quot;objective&quot;] # Final objective value (in units of the objective).</code></pre><p>The <code>&quot;solution&quot;</code> field contains detailed information about the solution produced by the <code>solve</code> method. For example, the following can be used to inspect the temporal variation in the volume of tank 1 in the water distribution network:</p><pre><code class="nohighlight hljs">tank_1_volume = Dict(nw=&gt;data[&quot;tank&quot;][&quot;10&quot;][&quot;V&quot;] for (nw, data) in result[&quot;solution&quot;][&quot;it&quot;][&quot;wm&quot;][&quot;nw&quot;])</code></pre><p>For more information about PowerWaterModels result data, see the <a href="../result-data/#PowerWaterModels-Result-Data-Format">PowerWaterModels Result Data Format</a> section.</p><h2 id="Accessing-Different-Formulations"><a class="docs-heading-anchor" href="#Accessing-Different-Formulations">Accessing Different Formulations</a><a id="Accessing-Different-Formulations-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-Different-Formulations" title="Permalink"></a></h2><p>As an example, to reformulate the previous problem using the <code>NFAUPowerModel</code> model for power flow and the <code>LRDWaterModel</code> model for water flow, which can then be jointly solved with HiGHS, the following can be executed:</p><pre><code class="language-julia hljs"># Instantiate a verbose version of the HiGHS optimizer.
highs_verbose = JuMP.optimizer_with_attributes(HiGHS.Optimizer, &quot;log_to_console&quot; =&gt; true)

# Specify the power and water formulation types jointly.
pwm_type_reformulation = PowerWaterModel{NFAUPowerModel, LRDWaterModel}

# Solve the joint optimal power-water flow problem and store the result.
result_reformulation = solve_opwf(data, pwm_type_reformulation, highs_verbose)</code></pre><h2 id="Modifying-Network-Data"><a class="docs-heading-anchor" href="#Modifying-Network-Data">Modifying Network Data</a><a id="Modifying-Network-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Modifying-Network-Data" title="Permalink"></a></h2><p>The following example demonstrates one way to perform PowerWaterModels solves while modifying network data.</p><pre><code class="language-julia hljs">for (nw, network) in data[&quot;it&quot;][&quot;wm&quot;][&quot;nw&quot;]
    network[&quot;demand&quot;][&quot;3&quot;][&quot;flow_nominal&quot;] *= 0.90
    network[&quot;demand&quot;][&quot;4&quot;][&quot;flow_nominal&quot;] *= 0.90
    network[&quot;demand&quot;][&quot;5&quot;][&quot;flow_nominal&quot;] *= 0.90
end

result_mod = solve_opwf(data, pwm_type, juniper)</code></pre><p>Note that the smaller demands in the modified problem result in an overall smaller objective value, i.e.,</p><pre><code class="language-julia hljs"># The comparison below should return `true`.
result_mod[&quot;objective&quot;] &lt; result[&quot;objective&quot;]</code></pre><p>For additional details about the network data, see the <a href="../network-data/#PowerWaterModels-Network-Data-Format">PowerWaterModels Network Data Format</a> section.</p><h2 id="Alternate-Methods-for-Building-and-Solving-Models"><a class="docs-heading-anchor" href="#Alternate-Methods-for-Building-and-Solving-Models">Alternate Methods for Building and Solving Models</a><a id="Alternate-Methods-for-Building-and-Solving-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Alternate-Methods-for-Building-and-Solving-Models" title="Permalink"></a></h2><p>The following example demonstrates how to decompose a <code>solve_opwf</code> call into separate model building and solving steps. This allows for inspection of the JuMP model created by PowerWaterModels:</p><pre><code class="language-julia hljs"># Instantiate the model.
pwm = instantiate_model(data, pwm_type, build_opwf);

# Print the contents of the JuMP model.
println(pwm.model)</code></pre><p>The problem can then be solved and its two result dictionaries can be stored via:</p><pre><code class="language-julia hljs"># Solve the PowerWaterModels problem and store the result.
result = PowerWaterModels._IM.optimize_model!(pwm, optimizer = juniper)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../network-data/">Network Data Format »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 20 December 2022 00:34">Tuesday 20 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
